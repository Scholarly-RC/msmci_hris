{% extends "layout.html" %}
{% block title %}User Attendance Management{% endblock %}
{% block content %}
    {% include "navbar.html" %}
    <div class="flex flex-col items-center px-4 2xl:px-0 pt-6 xl:gap-4 dark:bg-gray-900">
        <div class="w-full relative px-2 lg:px-10">
            <h1 class="text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white py-3 mt-10">User Attendance Management</h1>
            {% block user_attendance_management_section %}
                <div id="user_attendance_management_section"
                     class="flex flex-col gap-6 p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800">
                    <div class="w-full flex flex-col sm:flex-row gap-2">
                        <div class="w-full items-center sm:flex sm:divide-x sm:divide-gray-100 sm:mb-0 dark:divide-gray-700">
                            <div class="w-auto flex flex-col sm:flex-row justify-items-start gap-2">
                                <div class="max-w-sm">
                                    <div class="max-w-sm">
                                        <label for="selected_user"
                                               class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                                            Employee
                                        </label>
                                        <select id="selected_user"
                                                name="selected_user"
                                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                                hx-post="{% url "attendance:user_attendance_management" %}"
                                                hx-trigger="change"
                                                hx-include="[name='attendance_year'], [name='attendance_month']">
                                            <option value="0">Select Employee...</option>
                                            {% for user in users %}
                                                <option value="{{ user.id }}"
                                                        {% if selected_user.id == user.id %}selected{% endif %}>
                                                    {{ user.get_full_name|title }}
                                                    {% if user.get_full_name %}
                                                    {% else %}
                                                        {{ user.email }}
                                                    {% endif %}
                                                    - {{ user.userdetails.department }}
                                                </option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                                <div class="flex flex-row gap-2">
                                    <div class="max-w-sm">
                                        <label for="attendance_year"
                                               class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                                            Year
                                        </label>
                                        <input id="attendance_year"
                                               name="attendance_year"
                                               type="number"
                                               class="w-20 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                               min="2024"
                                               hx-post="{% url "attendance:user_attendance_management" %}"
                                               value="{{ selected_year }}"
                                               hx-trigger="input changed delay:200ms"
                                               hx-include="[name='selected_user'], [name='attendance_month']">
                                    </div>
                                    <div class="max-w-sm">
                                        <label for="attendance_month"
                                               class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                                            Month
                                        </label>
                                        <select id="attendance_month"
                                                name="attendance_month"
                                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                                hx-post="{% url "attendance:user_attendance_management" %}"
                                                hx-trigger="change"
                                                hx-include="[name='selected_user'],[name='attendance_year']">
                                            {% for month in list_of_months %}
                                                <option value="{{ month.1 }}"
                                                        {% if selected_month == month.1 %}selected{% endif %}>
                                                    {{ month.0 }}
                                                </option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <div class="inline-block min-w-full align-middle">
                            {% block user_management_attendance_table_container %}
                                <div id="user_management_attendance_table_container"
                                     class="h-[39rem] overflow-y-auto shadow">
                                    {% if monthly_record_data %}
                                        <table class="min-w-full divide-y divide-gray-200 table-fixed dark:divide-gray-600">
                                            <thead class="bg-gray-100 dark:bg-gray-700 sticky top-0">
                                                <tr>
                                                    <th scope="col"
                                                        class="p-4 text-xs font-medium text-left text-gray-500 uppercase dark:text-gray-400">
                                                        Day
                                                    </th>
                                                    <th scope="col"
                                                        class="p-4 text-xs font-medium text-left text-gray-500 uppercase dark:text-gray-400">
                                                        Shift
                                                    </th>
                                                    <th scope="col"
                                                        class="p-4 text-xs font-medium text-gray-500 uppercase dark:text-gray-400 text-center">
                                                        Time In
                                                    </th>
                                                    <th scope="col"
                                                        class="p-4 text-xs font-medium text-gray-500 uppercase dark:text-gray-400 text-center">
                                                        Time Out
                                                    </th>
                                                    <th scope="col"
                                                        class="p-4 text-xs font-medium text-gray-500 uppercase dark:text-gray-400 text-center">
                                                        Holiday
                                                    </th>
                                                    <th scope="col"
                                                        class="p-4 text-xs font-medium text-gray-500 uppercase dark:text-gray-400 text-center">
                                                        Overtime
                                                    </th>
                                                    <th scope="col"
                                                        class="p-4 text-xs font-medium text-gray-500 uppercase dark:text-gray-400 text-center">
                                                        On Leave
                                                    </th>
                                                    <th scope="col"
                                                        class="p-4 text-xs font-medium text-gray-500 uppercase dark:text-gray-400 text-center">
                                                        Modify
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700">
                                                {% for user_shift_data in monthly_record_data %}
                                                    {% block user_table_record %}
                                                        <tr class="hover:bg-gray-100 dark:hover:bg-gray-700">
                                                            <td class="flex items-center p-4 mr-12 space-x-6 whitespace-nowrap">
                                                                <div class="text-sm font-normal text-gray-500 dark:text-gray-400">
                                                                    <div class="text-base font-semibold text-gray-900 dark:text-white">{{ user_shift_data.day }}</div>
                                                                    <p class="text-gray-500 dark:text-gray-400">{{ user_shift_data.day_name }}</p>
                                                                </div>
                                                            </td>
                                                            <td class="max-w-sm p-4 overflow-hidden text-base font-bold text-gray-500 truncate xl:max-w-xs dark:text-gray-400">
                                                                <div class="text-sm font-normal text-gray-500 dark:text-gray-400">
                                                                    <div class="text-base font-semibold text-gray-900 dark:text-white">
                                                                        {{ user_shift_data.daily_user_shift.shift.description }}
                                                                    </div>
                                                                    <div class="text-sm font-semibold text-gray-500 dark:text-gray-400">
                                                                        {{ user_shift_data.daily_user_shift.shift.get_twelve_hour_format_shift_range }}
                                                                    </div>
                                                                    {% if user_shift_data.daily_user_shift.shift.get_twelve_hour_format_second_shift_range %}
                                                                        <div class="text-sm font-semibold text-gray-500 dark:text-gray-400">
                                                                            {{ user_shift_data.daily_user_shift.shift.get_twelve_hour_format_second_shift_range }}
                                                                        </div>
                                                                    {% endif %}
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <div class="flex flex-col p-4 whitespace-nowrap text-center">
                                                                    {% for data in user_shift_data.clocked_time_data.IN %}
                                                                        <p class="text-base font-medium text-gray-900 dark:text-white">{{ data.get_localtime_time|date:"h:i a" }}</p>
                                                                    {% endfor %}
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <div class="flex flex-col p-4 whitespace-nowrap text-center">
                                                                    {% for data in user_shift_data.clocked_time_data.OUT %}
                                                                        <p class="text-base font-medium text-gray-900 dark:text-white">{{ data.get_localtime_time|date:"h:i a" }}</p>
                                                                    {% endfor %}
                                                                </div>
                                                            </td>
                                                            <td class="p-4 text-base font-medium text-gray-900 whitespace-nowrap dark:text-white text-center">
                                                                {% if user_shift_data.holidays %}
                                                                    {% for holiday in user_shift_data.holidays %}{{ holiday.get_name_display }}{% endfor %}
                                                                {% endif %}
                                                            </td>
                                                            <td class="p-4 text-base font-medium text-gray-900 whitespace-nowrap dark:text-white text-center">
                                                                {% if user_shift_data.approved_overtime %}
                                                                    <svg class="mx-auto w-6 h-6 text-gray-800 dark:text-white"
                                                                         aria-hidden="true"
                                                                         xmlns="http://www.w3.org/2000/svg"
                                                                         width="24"
                                                                         height="24"
                                                                         fill="none"
                                                                         viewBox="0 0 24 24">
                                                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 11.917 9.724 16.5 19 7.5" />
                                                                    </svg>
                                                                {% endif %}
                                                            </td>
                                                            <td class="p-4 text-base font-medium text-gray-900 whitespace-nowrap dark:text-white text-center">
                                                                {% if user_shift_data.approved_leave %}
                                                                    <svg class="mx-auto w-6 h-6 text-gray-800 dark:text-white"
                                                                         aria-hidden="true"
                                                                         xmlns="http://www.w3.org/2000/svg"
                                                                         width="24"
                                                                         height="24"
                                                                         fill="none"
                                                                         viewBox="0 0 24 24">
                                                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 11.917 9.724 16.5 19 7.5" />
                                                                    </svg>
                                                                    {% for leave in user_shift_data.approved_leave %}
                                                                        <p class="text-gray-500 dark:text-gray-400">{{ leave.get_type_display }}</p>
                                                                    {% endfor %}
                                                                {% endif %}
                                                            </td>
                                                            <td class="p-4 text-base font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                                                {% if user_shift_data.daily_user_shift.shift %}
                                                                    <div class="flex justify-center">
                                                                        <button type="button"
                                                                                hx-get="{% url "attendance:modify_user_clocked_time" %}"
                                                                                hx-vals='{"selected_day": {{ user_shift_data.day }}}'
                                                                                hx-include="[name='selected_user'], [name='attendance_year'], [name='attendance_month']">
                                                                            <svg class="w-6 h-6"
                                                                                 fill="currentColor"
                                                                                 viewBox="0 0 20 20"
                                                                                 xmlns="http://www.w3.org/2000/svg">
                                                                                <path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"></path>
                                                                                <path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd">
                                                                                </path>
                                                                            </svg>
                                                                        </button>
                                                                    </div>
                                                                {% endif %}
                                                            </td>
                                                        </tr>
                                                    {% endblock %}
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    {% endif %}
                                </div>
                            {% endblock %}
                        </div>
                    </div>
                </div>
            {% endblock %}
            <!-- Modify Clocked Time Modal -->
            <div id="modify_clocked_time_modal"
                 tabindex="-1"
                 aria-hidden="true"
                 class="hidden fixed top-0 bottom-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-auto max-h-full">
                {% block modify_clocked_time_modal_container %}
                    <div id="modify_clocked_time_modal_container"
                         class="relative w-full max-w-4xl max-h-full">
                        <div class="relative bg-white rounded-lg shadow dark:bg-gray-700 mx-4">
                            <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                                <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Modify Clocked Time</h3>
                                <button hx-post="{% url "attendance:attendance_module_close_modals" %}"
                                        hx-vals='{"event_name": "closeModifyClockedTimeModal"}'
                                        type="button"
                                        class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white">
                                    <svg class="w-3 h-3"
                                         aria-hidden="true"
                                         xmlns="http://www.w3.org/2000/svg"
                                         fill="none"
                                         viewBox="0 0 14 14">
                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                                    </svg>
                                </button>
                            </div>
                            <div class="p-4 md:p-5 h-[20rem] md:h-[35rem] overflow-y-auto">
                                <div class="text-gray-900 whitespace-nowrap dark:text-white">
                                    <div class="text-base font-semibold">Employee: {{ selected_user.userdetails.get_user_fullname|title }}</div>
                                    <div class="text-base font-semibold">
                                        Date: <u>{{ selected_date }}</u>
                                    </div>
                                </div>
                                <div class="flex flex-row h-[15.5rem] overflow-y-auto">
                                    <div class="w-full relative overflow-x-auto">
                                        <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
                                            <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3">Clock In</th>
                                                    <th scope="col" class="px-6 py-3">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for data in clocked_time_data.IN %}
                                                    <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700">
                                                        <th scope="row"
                                                            class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                                            {{ data.get_localtime_time|date:"h:i a" }}
                                                        </th>
                                                        {% block clocked_in_action_section %}
                                                            <td class="px-2 py-2">
                                                                {% if delete_confirmation %}
                                                                    <button hx-delete="{% url 'attendance:delete_user_clocked_time' %}"
                                                                            hx-vals='{"attendance_record": {{ data.id }}}'
                                                                            type="button"
                                                                            class="px-2 py-1 text-xs font-medium text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 rounded-lg text-center dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900">
                                                                        Confirm
                                                                    </button>
                                                                    <button hx-post="{% url 'attendance:delete_user_clocked_time' %}"
                                                                            hx-vals='{"attendance_record": {{ data.id }}, "punch": "IN", "cancel": "true"}'
                                                                            type="button"
                                                                            class="px-2 py-1 text-xs font-medium text-yellow-400 hover:text-white border border-yellow-400 hover:bg-yellow-500 focus:ring-4 focus:outline-none focus:ring-yellow-300 rounded-lg text-center dark:border-yellow-300 dark:text-yellow-300 dark:hover:text-white dark:hover:bg-yellow-400 dark:focus:ring-yellow-900">
                                                                        Cancel
                                                                    </button>
                                                                {% else %}
                                                                    <button hx-get="{% url 'attendance:edit_user_clocked_time' %}"
                                                                            hx-vals='{"attendance_record": {{ data.id }}, "selected_date": "{{ selected_date_str }}"}'
                                                                            type="button"
                                                                            class="px-2 py-1 text-xs font-medium text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-lg text-center dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800">
                                                                        Edit
                                                                    </button>
                                                                    <button hx-post="{% url 'attendance:delete_user_clocked_time' %}"
                                                                            hx-vals='{"attendance_record": {{ data.id }}, "punch": "IN"}'
                                                                            type="button"
                                                                            class="px-2 py-1 text-xs font-medium text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 rounded-lg text-center dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900">
                                                                        Delete
                                                                    </button>
                                                                {% endif %}
                                                            </td>
                                                        {% endblock %}
                                                    </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="w-full relative overflow-x-auto">
                                        <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
                                            <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3">Clock Out</th>
                                                    <th scope="col" class="px-6 py-3">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for data in clocked_time_data.OUT %}
                                                    <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700">
                                                        <th scope="row"
                                                            class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                                            {{ data.get_localtime_time|date:"h:i a" }}
                                                        </th>
                                                        {% block clocked_out_action_section %}
                                                            <td class="px-2 py-2">
                                                                {% if delete_confirmation %}
                                                                    <button hx-delete="{% url 'attendance:delete_user_clocked_time' %}"
                                                                            hx-vals='{"attendance_record": {{ data.id }}}'
                                                                            type="button"
                                                                            class="px-2 py-1 text-xs font-medium text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 rounded-lg text-center dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900">
                                                                        Confirm
                                                                    </button>
                                                                    <button hx-post="{% url 'attendance:delete_user_clocked_time' %}"
                                                                            hx-vals='{"attendance_record": {{ data.id }}, "punch": "IN", "cancel": "true"}'
                                                                            type="button"
                                                                            class="px-2 py-1 text-xs font-medium text-yellow-400 hover:text-white border border-yellow-400 hover:bg-yellow-500 focus:ring-4 focus:outline-none focus:ring-yellow-300 rounded-lg text-center dark:border-yellow-300 dark:text-yellow-300 dark:hover:text-white dark:hover:bg-yellow-400 dark:focus:ring-yellow-900">
                                                                        Cancel
                                                                    </button>
                                                                {% else %}
                                                                    <button hx-get="{% url 'attendance:edit_user_clocked_time' %}"
                                                                            hx-vals='{"attendance_record": {{ data.id }}, "selected_date": "{{ selected_date_str }}"}'
                                                                            type="button"
                                                                            class="px-2 py-1 text-xs font-medium text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-lg text-center dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800">
                                                                        Edit
                                                                    </button>
                                                                    <button hx-post="{% url 'attendance:delete_user_clocked_time' %}"
                                                                            hx-vals='{"attendance_record": {{ data.id }}, "punch": "OUT"}'
                                                                            type="button"
                                                                            class="px-2 py-1 text-xs font-medium text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 rounded-lg text-center dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900">
                                                                        Delete
                                                                    </button>
                                                                {% endif %}
                                                            </td>
                                                        {% endblock %}
                                                    </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                {% block modify_clocked_time_section %}
                                    <div id="modify_clocked_time_section">
                                        <form {% if for_update %} hx-post="{% url 'attendance:edit_user_clocked_time' %}" hx-vals='{"attendance_record": {{ attendance_record.id }}, "selected_date": "{{ selected_date_str }}"}' {% else %} hx-post="{% url 'attendance:add_user_clocked_time' %}" hx-vals='{"selected_user": {{ selected_user.id }}, "selected_date": "{{ selected_date_str }}"}' {% endif %}
                                              class="w-[20rem] flex flex-col gap-2 mx-auto bg-white dark:bg-gray-800 p-2">
                                            <div>
                                                <label for="clocked_time"
                                                       class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                                                    Select time:
                                                </label>
                                                <div class="flex">
                                                    <input type="time"
                                                           id="clocked_time"
                                                           name="clocked_time"
                                                           class="rounded-none rounded-s-lg bg-gray-50 border text-gray-900 leading-none focus:ring-blue-500 focus:border-blue-500 block flex-1 w-full text-sm border-gray-300 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                                           value="{{ attendance_record.get_localtime_time_str }}"
                                                           required>
                                                    <span class="inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border rounded-s-0 border-s-0 border-gray-300 rounded-e-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600">
                                                        <svg class="w-4 h-4 text-gray-500 dark:text-gray-400"
                                                             aria-hidden="true"
                                                             xmlns="http://www.w3.org/2000/svg"
                                                             fill="currentColor"
                                                             viewBox="0 0 24 24">
                                                            <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z" clip-rule="evenodd" />
                                                        </svg>
                                                    </span>
                                                </div>
                                            </div>
                                            <div>
                                                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Select Punch:</label>
                                                <ul class="items-center w-full text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg sm:flex dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                                    <li class="w-full border-b border-gray-200 sm:border-b-0 sm:border-r dark:border-gray-600">
                                                        <div class="flex items-center ps-3">
                                                            <input id="clock_in_punch"
                                                                   type="radio"
                                                                   value="IN"
                                                                   name="punch"
                                                                   class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"
                                                                   {% if attendance_record.punch == 'IN' %}checked{% endif %}
                                                                   required>
                                                            <label for="clock_in_punch"
                                                                   class="w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                                                                Clock In
                                                            </label>
                                                        </div>
                                                    </li>
                                                    <li class="w-full dark:border-gray-600">
                                                        <div class="flex items-center ps-3">
                                                            <input id="clock_out_punch"
                                                                   type="radio"
                                                                   value="OUT"
                                                                   name="punch"
                                                                   class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"
                                                                   {% if attendance_record.punch == 'OUT' %}checked{% endif %}
                                                                   required>
                                                            <label for="clock_out_punch"
                                                                   class="w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                                                                Clock Out
                                                            </label>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                            <div class="w-full flex justify-center">
                                                <button type="submit"
                                                        class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800">
                                                    {% if for_update %}
                                                        Save
                                                    {% else %}
                                                        Add
                                                    {% endif %}
                                                </button>
                                                {% if for_update %}
                                                    <button hx-get="{% url 'attendance:edit_user_clocked_time' %}"
                                                            hx-vals='{"cancel": "True"}'
                                                            type="button"
                                                            class="text-yellow-400 hover:text-white border border-yellow-400 hover:bg-yellow-500 focus:ring-4 focus:outline-none focus:ring-yellow-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2 dark:border-yellow-300 dark:text-yellow-300 dark:hover:text-white dark:hover:bg-yellow-400 dark:focus:ring-yellow-900">
                                                        Cancel
                                                    </button>
                                                {% endif %}
                                            </div>
                                        </form>
                                    </div>
                                {% endblock %}
                            </div>
                        </div>
                    </div>
                {% endblock %}
            </div>
        </div>
    </div>
{% endblock %}
{% block javascript %}
    <script>
        htmx.onLoad(function(content) {
            content.addEventListener("reloadModifyClockedTimeList", (event) => {
                const {
                    userId,
                    selectedDate,
                } = event.detail;

                const safeDetail = {
                    userId,
                    selectedDate,
                };

                htmx.ajax("POST", '{% url "attendance:reload_modify_clocked_time_list" %}', {
                    values: {
                        details: JSON.stringify(safeDetail),
                    },
                });
            });


            // Initialize specific modals
            const initializeModifyClockedTimeModal = () => initializeModal('modify_clocked_time_modal');
            const closeModifyClockedTimeModal = () => closeModal('modify_clocked_time_modal');

            // Event listeners for modals
            content.addEventListener('openModifyClockedTimeModal', initializeModifyClockedTimeModal);
            content.addEventListener('closeModifyClockedTimeModal', closeModifyClockedTimeModal);
        })
    </script>
{% endblock %}
